function getBaseName()  {    var myWindow = new Window ("dialog", "Rename Selected Items");     var myInputGroup = myWindow.add ("group");    myInputGroup.add ("statictext", undefined, "Base Name:");    var myText = myInputGroup.add ("edittext", undefined, "base-name_");    myText.characters = 20;    myText.active = true;    var myButtonGroup = myWindow.add ("group");    myButtonGroup.alignment = "right"; myButtonGroup.add ("button", undefined, "OK"); myButtonGroup.add ("button", undefined, "Cancel");    if (myWindow.show () == 1){        return myText.text;    } else {        return 0;    }}function rename(sel, basename){    //if items are grouped, and everything in the group is selected, illustrator returns just the group instead of individual items    for(var i = 0; i < sel.length; i++)    {        if(sel[i].typename == 'GroupItem')        {            rename(sel[i].pathItems, basename);        }         else         {            sel[i].name = basename+ '_'+i;        }    } }function  main(){    if ( app.documents.length > 0 ) {        doc = app.activeDocument;        //~     if(!doc.saved){//~        Window.alert("This script needs to modify your document. Please save it before running this script.");//~     } else {                var selected = doc.selection;                 //if none selected do error        var basename = getBaseName(doc);        if(basename)            rename(selected, basename);//~     }    }else{        Window.alert("You must open at least one document.");    }  }main();
function  main(){    if ( app.documents.length > 0 ) {        doc = app.activeDocument;                    doc.selection  = null;    $.writeln('----------------------');            var layer = doc.layers.add();        var pgroup = layer.groupItems.add();        pgroup.name = 'rehearsal-marks';                var count = 0;        var ab = doc.artboards;        var nabs = ab.length;        app.coordinateSystem = CoordinateSystem.ARTBOARDCOORDINATESYSTEM;          for( var a = 0; a < nabs; a++ )        {            doc.selection  = null;            doc.artboards.setActiveArtboardIndex( a ); // activate each artboard            doc.selectObjectsOnActiveArtboard(); // select all in artboard                    layer.locked = false;                    layer.visible = true;                                var items = doc.selection;            for(var j = 0; j < items.length; j++)            {                if(items[j].typename == 'GroupItem' && items[j].name.search('system') >= 0)                {    $.writeln('count '+count);                    var ab = doc.artboards[ a ];                    var x1 = ab.artboardRect[0];                    var y1 = ab.artboardRect[1];                    var numbox = pgroup.groupItems.add();                    numbox.name = 'rehearsal-mark';                    var pnum = numbox.textFrames.add();                    pnum.contents = String(++count);                    pnum.stroked = false;                    pnum.fillColor = 'black';                    pnum.name = 'rehearsal-number';                    pnum.position = [0, 0];                    pnum.textRange.justification = Justification.CENTER;                    var diam = Math.ceil(pnum.height > pnum.width ? pnum.height : pnum.width);                    var rad = Math.ceil(diam / 2.);                    var box = numbox.pathItems.rectangle(0, 0, diam, diam);                    box.stroked = true;                    box.filled = false;                    box.translate(-rad, -rad+Math.ceil(pnum.height/2));                                        var cc = items[j];                    var px = x1 + cc.left - pnum.width - 10;//((x2 - x1) / 2)                    var py = y1 + cc.top - (cc.height / 2) + (pnum.height / 2);                                        numbox.translate(px, py);                                    }            }        }    }else{        Window.alert("You must open at least one document.");    }}main();
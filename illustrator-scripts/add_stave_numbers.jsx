function  main(){    if ( app.documents.length > 0 ) {        doc = app.activeDocument;    $.writeln('----------------------');        var layers = doc.layers;        var nlayers = layers.length;        var count = 0;                for( var i = 0; i < nlayers; i++)        {            items = layers[i].pageItems;            for(var j = 0; j < items.length; j++)            {                if(items[j].typename == 'GroupItem' && items[j].name.search('stave') >= 0)                {                   // make rehearsal numbers (same as page numbers for now)                    var pgroup = items[j];                    var numbox = pgroup.groupItems.add();                numbox.name = 'rehearsal-mark';                            var pnum = numbox.textFrames.add();                pnum.contents = String(i+1);                pnum.stroked = false;                pnum.fillColor = 'black';                pnum.name = 'rehearsal-number';                                   pnum.position = [0, 0];                pnum.textRange.justification = Justification.CENTER;                               var diam = Math.ceil(pnum.height > pnum.width ? pnum.height : pnum.width);                var rad = Math.ceil(diam / 2.);                var box = numbox.pathItems.rectangle(0, 0, diam, diam);                box.stroked = true;                box.filled = false;                box.translate(-rad, -rad+Math.ceil(pnum.height/2));                                var px = cc.left - pnum.width - 10;//((x2 - x1) / 2)                var py = cc.top - (cc.height / 2) + (pnum.height / 2);                                numbox.translate(px, py);                                                         items[j].name = 'stave-'+( ++count );                }            }                    }                          }else{        Window.alert("You must open at least one document.");    }  }main();